//
//  VMQemuVGA.xcconfig
//  VMQemuVGA Code Signing Configuration
//

// Include the base configuration
ALWAYS_SEARCH_USER_PATHS = NO;
DEBUG_INFORMATION_FORMAT = dwarf-with-dsym;
DEPLOYMENT_POSTPROCESSING = YES;
GCC_ENABLE_CPP_EXCEPTIONS = NO;
GCC_ENABLE_CPP_RTTI = NO;
GCC_ENABLE_OBJC_EXCEPTIONS = NO;
GCC_WARN_64_TO_32_BIT_CONVERSION = YES;
GCC_WARN_ABOUT_RETURN_TYPE = YES;
GCC_WARN_SIGN_COMPARE = YES;
GCC_WARN_UNINITIALIZED_AUTOS = YES;
GCC_WARN_UNUSED_VARIABLE = YES;

// MacKernelSDK Configuration for x86_64
HEADER_SEARCH_PATHS = $(PROJECT_DIR)/MacKernelSDK/Headers $(PROJECT_DIR)/qemu;
LIBRARY_SEARCH_PATHS = $(PROJECT_DIR)/MacKernelSDK/Library/universal;
OTHER_LDFLAGS = -lkmod;
GCC_PREPROCESSOR_DEFINITIONS = KERNEL KERNEL_PRIVATE MACH_KERNEL_PRIVATE PRIVATE;

// x86_64 targeting flags (macOS 10.6+ support)
ARCHS = x86_64;
MACOSX_DEPLOYMENT_TARGET = 10.6;
OTHER_CFLAGS = -static -nostdlib -Wno-stdlibcxx-not-found -target x86_64-apple-macos10.6 -fallow-unsupported -fno-stack-protector -fno-jump-tables -fvisibility=default;
OTHER_LDFLAGS = -static -target x86_64-apple-macos10.6 -lkmod -Wl,-all_load;
CLANG_CXX_LIBRARY = ;

// Modern Kernel Extension Build Settings
KERNEL_EXTENSION = YES;
KERNEL_FRAMEWORK = IOKit;

// Code Signing Configuration - Disabled for Snow Leopard compatibility
CODE_SIGN_IDENTITY = ;
CODE_SIGN_ENTITLEMENTS = ;

// Override header map style warning
USE_HEADERMAP = NO;

// Enhanced build settings for signed kext
MODULE_NAME = com.vmware.kext.VMQemuVGA;
MODULE_VERSION = 8.0.0;
